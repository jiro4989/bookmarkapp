= bookmarkapp
:toc: left
:sectnums:

Kubernetesの勉強でWebアプリでも作ってみる。

== 方針

. 勉強目的なので凝ったアプリ仕様にはしない
. Web UIも手を抜く
. フロントエンドは React.js
. バックエンドは Nim
. Kubernetes + Skaffold + Helm を使う
. ユーザ向けUIを作る
. 社内管理者用UIを作る
. バッチを作る
. フリーユーザ、課金ユーザ用の仕組みを作る
. パスワード認証を必須とする
. 権限管理の仕組みを作る (RBAC)
. 請求の仕組みを作る
. 自動テストできるようにする
. RDB (MySQL)を使う
. 可能ならマイクロサービスアーキテクチャにする

== アプリ概要

- ブックマークを管理するWebアプリ
- ブックマークには任意のタグを0個以上設定できる
- ブックマークにはメモをつけられる
- ブックマークは検索できる
- 課金すると複数人でブックマークを共有できるようになる
- ブックマークの数で課金される
- フリートライアル期間7日が1度だけ使える
- 社内管理者用UIからはユーザの利用を再開・停止できる
- 社内管理者用UIからはユーザにメール配信できる
- 社内管理者用UIにはユーザごとに操作できる権限がある

「こんなアプリいらんでしょ」と思ったあなた、その感覚は正常です。
僕ならこんなアプリに金払おうとは思わない。

== 開発者向け

=== 環境構築

以下が必要

- docker
- kubectl
- skaffold
- helm

kubectl については Windows の DockerDesktop のKubernetesを有効にしたら使えた気が
する。

=== アプリの起動

以下のコマンドを実行すると `skaffold dev` が走って自動ビルド状態になる。

[source,bash]
----
make dev
----

=== 疎通確認

[source,bash]
----
make healthcheck
----
